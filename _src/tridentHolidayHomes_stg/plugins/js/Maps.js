let infoWindow,sidebarMaxHeight,markersChanged=[],clustersVisibles=1,windowSize=window.innerWidth,lastWindowSize,idFavorito,map,multiphoto=0,flexibleSearchMap=0,isLoadingData=!1;document.getElementById("flexible-search")&&(flexibleSearchMap=document.getElementById("flexible-search").value);const bk=document.getElementById("bk-map").value,idioma=document.getElementById("idioma-map").value,purpose=document.getElementById("FRMPurpose").value,galeriaDinamica=document.getElementById("galeriaDinamica").value,hasGaleriaDinamica="1"===galeriaDinamica?"owl-carousel":"",skin=document.querySelector('input[name="skin"]').value,mapsData=document.getElementById("maps-data"),modeResort=document.getElementById("modeResort"),mouseover=Number(document.getElementById("mouseover-map").value),mapTypeSelected=Number(document.getElementById("map-type-selected").value),datosBusqueda=mapsData.dataset.busqueda,datosRequest=mapsData.dataset.request,url=mapsData.dataset.url,Maps=function(a,e){this.data=a,this.type=e};Maps.prototype={getHtmlResort:function(a,e){let i='<div class="wrapper-custom-marker"><div class="custom-marker"><div id="galery_'+a.idResort+'" class="fotografiaR '+hasGaleriaDinamica+'">';return a.slider.forEach(function(s){i+="<a "+e.target+' href="'+a.url+'" title="'+a.nombre+'" aria-label="'+a.nombre+'"><img class="owl-lazy" loading="lazy" alt="'+a.nombre+'" data-src="'+s+'" data-owl-src="'+s+'"></a>'}),i+='</div><div class="valoracion_resultados" style="'+e.showRatings+'"><div class="MediaValoraciones">'+a.valoraciones+"</div></div>",i+='</div><div class="custom-marker2"><div class="map-cabecera"><span class="name">'+a.nombre+'</span></div><div class="map-table">'+a.precio+"</div></div></div>"},getHtmlRedesign:function(a,e){let i,s="";if("redesign"===skin){let t=null!=a.valoraciones?"has-reviews":"";return i='<div class="wrapper-custom-marker"><div class="custom-marker"><div id="galery_'+a.id+'" class="fotografiaR '+hasGaleriaDinamica+" "+t+'">',"1"===galeriaDinamica?jQuery(a.slider.imagenesTour).each(function(){if(this.esVideo)return!0;i+="<a "+e.target+' href="'+a.url+'" title="'+a.nombre+'" aria-label="'+a.nombre+'"><img class="owl-lazy" loading="lazy" alt="'+a.nombre+'" data-src="'+a.directorio+this.fichero_big+'" data-owl-src="'+a.directorio+this.fichero_big+'"></a>'}):i+="<a "+e.target+' href="'+a.url+'" title="'+a.nombre+'" aria-label="'+a.nombre+'"><img loading="lazy" alt="'+a.nombre+'" data-src="'+a.img.Imagen+'" src="'+a.img.Imagen+'" title="'+a.nombre+'"></a>',i+='</div><div class="valoracion_resultados" style="'+e.showRatings+'"><div class="MediaValoraciones">'+a.valoraciones+'</div></div><div class="info_alojamiento">',a.capacidadpersonas>0&&(i+='<span><i class="svg-occupants" alt="'+a.textopersonas+'" title="'+a.textopersonas+'"></i>'+a.capacidadpersonas+"</span> "),a.dormitorios>0&&(i+='<span><i class="svg-bedrooms" alt="'+a.textohabitaciones+'" title="'+a.textohabitaciones+'"></i>'+a.dormitorios+"</span>"),i+="</div>",null!=a.fomoNotification&&(s=a.fomoNotification),i+='</div><div class="custom-marker2 bg-marker2"><div class="map-cabecera"><span class="name">'+a.nombre+'</span><i class="fas fa-map-marker-alt fa-lg marginR5"></i><span class="type">'+a.contenidoTagsSubcabecera+"</span></div>"+s+a.flexibleSearch+'<div class="map-table">'+a.precio+"</div></div></div>"}},getHtmlRedesignMultiphoto:function(a,e){let i,s="",t="",o="";if("redesign"===skin)return i='<div class="wrapper-custom-marker resultados-multiphoto '+(s=a.slider.imagenesTour?"":"without-photos")+'"><div class="custom-marker"><div id="galery_'+a.id+'" class="fotografiaR '+hasGaleriaDinamica+'">',"1"===galeriaDinamica?jQuery(a.slider.imagenesTour).each(function(){if(this.esVideo)return!0;i+="<a "+e.target+' href="'+a.url+'" title="'+a.nombre+'" aria-label="'+a.nombre+'"><img class="owl-lazy" loading="lazy" alt="'+a.nombre+'" data-src="'+a.directorio+this.fichero_big+'" data-owl-src="'+a.directorio+this.fichero_big+'"></a>'}):i+="<a "+e.target+' href="'+a.url+'" title="'+a.nombre+'" aria-label="'+a.nombre+'"><img loading="lazy" alt="'+a.nombre+'" data-src="'+a.img.Imagen+'" src="'+a.img.Imagen+'"></a>',i+="</div>",a.slider.imagenesTour&&(i+='<div class="multiphoto">',jQuery(a.slider.imagenesTour).each(function(s){return!!this.esVideo||s<1||(i+="<a "+e.target+' href="'+a.url+'" title="'+a.nombre+'" aria-label="'+a.nombre+'"><div class="container-image"><img class="owl-lazy" loading="lazy" alt="'+a.nombre+'" data-src="'+a.directorio+this.fichero_thumb+'" src="'+a.directorio+this.fichero_thumb+'"></div></a>',!(s>=4)&&void 0)}),i+="</div>"),i+='<div class="info_alojamiento">',a.capacidadpersonas>0&&(i+='<span><i class="svg-occupants" alt="'+a.textopersonas+'" title="'+a.textopersonas+'"></i>'+a.capacidadpersonas+"</span> "),a.dormitorios>0&&(i+='<span><i class="svg-bedrooms" alt="'+a.textohabitaciones+'" title="'+a.textohabitaciones+'"></i>'+a.dormitorios+"</span>"),i+="</div>",""!==a.flexibleSearch&&(t="flexible-search-map"),null!=a.fomoNotification&&(o=a.fomoNotification),i+='</div><div class="custom-marker2 '+t+'"><div class="map-cabecera"><span class="name">'+a.nombre+'</span><i class="fas fa-map-marker-alt fa-lg marginR5"></i><span class="type">'+a.contenidoTagsSubcabecera+"</span></div>"+o+'<div class="valoracion_resultados" style="'+e.showRatings+'"><div class="MediaValoraciones">'+a.valoraciones+"</div></div>"+a.flexibleSearch+'<div class="map-table">'+a.precio+"</div></div></div>"},getHtmlLite:function(a,e){let i,s="";return a.hotel?(i=a.tipo,a.img.Imagen=a.imghotel):"VENTA"!=jQuery("#FRMPurpose").val()?(i=a.tipo+'<span class="fa fa-user" alt="'+a.textopersonas+'" title="'+a.textopersonas+'">'+a.capacidadpersonas+"</span>",a.dormitorios&&(i=i+'<span class="fa fa-bed" alt="'+a.textohabitaciones+'" title="'+a.textohabitaciones+'">'+a.dormitorios+"</span>")):i=a.tipo+'<span class="fa fa-bed" alt="'+a.textohabitaciones+'" title="'+a.textohabitaciones+'">'+a.dormitorios+"</span>",""!=a.precio&&(s='<span class="price">'+a.precio+"</span>"),htmlLite='<div class="wrapper-custom-marker"><div class="custom-marker"><a '+e.target+' href="'+a.url+'" title="'+a.nombre+'" aria-label="'+a.nombre+'"><img loading="lazy" alt="'+a.nombre+'" data-src="'+a.img.Imagen+'" src="'+a.img.Imagen+'"></a>'+s+'</div><div class="custom-marker2"><a href="'+a.url+'" title="'+a.nombre+'" aria-label="'+a.nombre+'"><span class="bottom"><span class="type">'+a.nombre+'</span><span class="message">'+i+"</span></span></a></div></div>"},getHtmlMultiHouse:function(a,e){let i,s="_self";e.target&&(s="_blank"),i='<div style="cursor: pointer" onclick="window.open(\''+a.url+"', '"+s+'\');"><div class="wrapper-multihouse-marker"><div class="multihouse-marker-left"><img loading="lazy" alt="'+a.nombre+'" data-src="'+a.img.Imagen+'" src="'+a.img.Imagen+'"></div><div class="multihouse-marker-right"><div><div class="info_alojamiento">',a.capacidadpersonas>0&&(i+='<span><i class="svg-occupants" alt="'+a.textopersonas+'" title="'+a.textopersonas+'"></i>'+a.capacidadpersonas+"</span> "),a.dormitorios>0&&(i+='<span><i class="svg-bedrooms" alt="'+a.textohabitaciones+'" title="'+a.textohabitaciones+'"></i>'+a.dormitorios+"</span>"),i+="</div>",i+='<div class="map-cabecera"><span class="name">'+a.nombre+"</span>";let t=a.ciudad;return"redesign"===skin&&(t=a.contenidoTagsSubcabecera),i+='<div><i class="fas fa-map-marker-alt fa-lg marginR5"></i><span class="type">'+t+"</span></div>",i+="</div></div>","redesign"===skin&&a.flexibleSearch&&(i+=a.flexibleSearch),i+='<div class="map-table">'+a.precio+"</div></div></div></div>"},getInfoWindow:function(a){let e=this,i={target:"",showRatings:"display:block",setFavorito:"display:block",delFavorito:"display:none"};if(a.targetBlank&&(i.target=" target='_blank' "),a.valoraciones||(i.showRatings="display:none"),a.favorito&&(i.setFavorito="display:none",i.delFavorito="display:block"),"redesign"===skin&&a.modeResort)return this.getHtmlResort(a,i);if(Array.isArray(a)){let s="";return a.forEach(function(a){s+=e.getHtmlMultiHouse(a,i)}),s}return"redesign"===skin?1==(multiphoto=document.getElementById("multiphoto").value)?this.getHtmlRedesignMultiphoto(a,i):this.getHtmlRedesign(a,i):this.getHtmlLite(a,i)},getAccommodationData:function(a,e){let i={bk:bk,Idioma:idioma,id:a.id,idCRS:a.idCRS,loginGa:a.loginGa,FRMPurpose:purpose,datosRequest:datosRequest,datosBusqueda:datosBusqueda,type:"window",dateFrom:$("#dateFrom").val(),dateTo:$("#dateTo").val(),AdultNum:$("#AdultNum").val(),ChildrenNum:$("#ChildrenNum").val(),Child_1_Age:$("#Child_1_Age").val(),Child_2_Age:$("#Child_2_Age").val(),Child_3_Age:$("#Child_3_Age").val(),Child_4_Age:$("#Child_4_Age").val(),Child_5_Age:$("#Child_5_Age").val(),Child_6_Age:$("#Child_6_Age").val()};modeResort&&1==modeResort.value&&(i.modeResort=1,i.idResort=a.idResort),a.multiHouse&&(i.multiHouse=1),isLoadingData||(isLoadingData=!0,document.body.style.cursor="wait",jQuery.ajax({url:url+"?action=mapsdata",contentType:"application/json",async:"true",dataType:"json",data:i,type:"GET",success:function(i){i.latitud=a.latitud,i.longitud=a.longitud,i.idResort=a.idResort,i.loginGa=a.loginGa,isLoadingData=!1,document.body.style.cursor="default",e(i)}}))},getAccommodationMultiHouseData:function(a,e){let i=[],s=0;function t(){let a=i.slice(s,s+4),t={bk:bk,Idioma:idioma,FRMPurpose:purpose,datosRequest:datosRequest,datosBusqueda:datosBusqueda,type:"window",multiHouse:1,accommodations:a,dateFrom:$("#dateFrom").val(),dateTo:$("#dateTo").val(),AdultNum:$("#AdultNum").val(),ChildrenNum:$("#ChildrenNum").val(),Child_1_Age:$("#Child_1_Age").val(),Child_2_Age:$("#Child_2_Age").val(),Child_3_Age:$("#Child_3_Age").val(),Child_4_Age:$("#Child_4_Age").val(),Child_5_Age:$("#Child_5_Age").val(),Child_6_Age:$("#Child_6_Age").val()};s+=4,isLoadingData||(isLoadingData=!0,document.body.style.cursor="wait",jQuery.ajax({url:url+"?action=mapsdata",contentType:"application/json",async:"true",dataType:"json",data:t,type:"GET",beforeSend:function(){if(s>4){let a=document.createElement("i");a.className="icon-spin4 fwk-color",document.getElementById("multiHouseContainer").appendChild(a)}},success:function(a){e(a,s),document.body.querySelector("#multiHouseContainer .icon-spin4")&&document.body.querySelector("#multiHouseContainer .icon-spin4").remove(),isLoadingData=!1,document.body.style.cursor="default"}}))}a.forEach(function(a){let e={id:a.id,idCRS:a.idCRS,loginGa:a.loginGa};modeResort&&1==modeResort.value&&(e.modeResort=1,e.idResort=a.idResort),i.push(e)}),0===s&&t(),s>=4&&document.addEventListener("scroll",function(a){i.length>s&&"multiHouseContainer"===a.target.id&&jQuery("#multiHouseContainer").scrollTop()+jQuery("#multiHouseContainer").innerHeight()>=jQuery("#multiHouseContainer")[0].scrollHeight&&!document.body.querySelector("#multiHouseContainer .icon-spin4")&&(t(),a.stopPropagation())},!0)},setStyles:function(){let a=window.screen.width;a<=425&&2==this.mapTypeSelected&&map.panTo(new google.maps.LatLng({lat:marker.latitude,lng:marker.longitude})),jQuery(".its--container").length>0&&(jQuery(".bottom").css("color",jQuery("header#header #upper_header").css("color")),jQuery(".bottom").css("background-color",jQuery("header#header #upper_header").css("background-color")),jQuery(".capacity").css("color",jQuery("header#header #upper_header").css("color")),jQuery(".capacity").css("background-color",jQuery("header#header #upper_header").css("background-color")),jQuery("span.fa.fa-user").css("color",jQuery("header#header #upper_header").css("background-color")),jQuery("span.fa.fa-user").css("background-color",jQuery("header#header #upper_header").css("color")),jQuery("span.fa.fa-bed").css("color",jQuery("header#header #upper_header").css("background-color")),jQuery("span.fa.fa-bed").css("background-color",jQuery("header#header #upper_header").css("color"))),"redesign"===skin&&(idFavorito="#"+jQuery(".custom-marker .favoritos_res").attr("data-id"),(galeriaDinamica>0||modeResort&&1==modeResort.value)&&loaDivdGalery(".fotografiaR"),"results"==this.type&&addFavoritosMapa(idFavorito))}};